# kurisaba
A nullchan-kusabaX based imageboard engine with some modern features

## Установка

Этот процесс пока что не проверялся, но всё должно выглядеть так.

Если кто-то захочет развернуть курисабу у себя с нуля и поделится с нами своим опытом, например, в виде написания issue-в на github - мы будем очень рады.

- Скопировать шаблон config.php.template из каталога template в корень борды, поправить в нём необходимые поля (они все собраны в одном помеченном соответствующими словами месте).
- Создать базу данных с любым названием (если ещё не создана).
- Импортировать файл database.sql в эту базу.
- Добавить пользователя-админа в таблицу staff.
- Создать каталоги tmp, tmp/dwoo (настраивается в конфиге), tmp/xhrupload. Они должны быть доступны для записи веб-серверу. Можно удалить каталог _templates.
- После этого можно заходить в админку (http://example.com/manage.php) и создавать секции (по умолчанию определена секция "борды") и доски на них.
- Можно модифицированть главную (`front.php`) в соответствии с тематикой борды и поправить `KU_MAINPAGE` в конфиге. Для примера, главная Курисача есть в отдельном [репозитории](https://github.com/makise-homura/kurisach-resources).

## Конфиг

Параметры в конфиге (по крайней мере, которые стоит трогать) описаны прямо в нём.

## Админка

По сравнению с обычной кусабой в админке есть специальные пункты:
- пересоздать статическую карту ответов: так как карта ответов, в отличие от обычной 0chan-кусабы в курисабе статическая, то после массивных правок досок (к примеру, переноса тредов или влива дампа базы) она может сломаться, тогда следует выбрать этот пункт.
- сбросить лимит тредов: с целью защиты от вайпа в день можно создать не более KU_MAXTHREADSADAY тредов. Если нужно создать больше, то нужно выбрать этот пункт, и тогда отсчет KU_MAXTHREADSADAY пойдет с текущего момента, а не 24 часов до него, и можно будет создать новые KU_MAXTHREADSADAY тредов.
- специальные треды. О них ниже.
Есть также пункт "подневная статистика по бордам /sg/ и /vg/" - его вообще можно выпилить или переделать так, как надо (этот пункт специфичен для "Курисача", первой и, собственно, родной борды для курисабы).

## Специальные треды

Некоторые треды могут быть доступны по коротким ссылкам и из меню.

Их можно добавить в списке тредов для меню на странице "специальные треды" админки.

Формат записи:
```
{THREAD | HIDDEN} thread-id /link/ Thread-Name
```
Здесь:
- `THREAD` - показать тред в меню и сделать возможность переходить в него по ссылке
- `HIDDEN` - не показывать тред в меню, но всё равно сделать возможность переходить в него по ссылке
- `thread-id` - id ОП-поста,
- `link` - это ссылка, по которой он будет доступен,
- `Thread-Name` - имя треда, под которым он появляется в меню.
Каждый блок записей THREAD/HIDDEN должна предварять строка вида `BOARD boardname`, где `boardname` - имя доски (без слэшей). Эта строка показывает, к какой борде относятся последующие треды.

К примеру, если там написано:
```
BOARD b
THREAD 12345 /vid/ Video Thread
```
то это означает, что в тред можно зайти как по обычной ссылке вида http://example.com/b/res/12345.html, так и по ссылке http://example.com/vid/.

Очевидно, названия имеющихся досок не должны совпадать с подобными ссылками на треды.

Если существует такой тред со ссылкой `/faq/` - то в хедере страниц борд/тредов, а также в меню появится ссылка "FAQ". Этот тред логично объявить как HIDDEN, заблокировать и спрятать, чтобы он мог быть доступен только по ссылке, но не светился на борде.

## Пару слов про лицензию

Основная лицензия проекта - GPLv2.

Однако, поскольку как сама Kusaba X, так и 0chan-Kusaba в своём составе имеет много компонентов и там могут возникать проблемы с лицензиями, то для курисабы эта болезнь тоже справедлива.

Иконки файлов (`inc/filetypes/*.png`) сделаны на основе [иконки](https://www.svgrepo.com/svg/480190/music-file-4) авторства Icooon Mono с лицензией public domain и шрифта [Arturito Slab](https://fonts-online.ru/fonts/arturito-slab) авторства Denis Ignatov с лицензией SIL OFL 1.1.
